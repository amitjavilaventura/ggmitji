# Create base boxplot with geom_boxplot, stat_boxplot or stat_summary_boxplot
p <- ggplot(mpg, aes(class, hwy)) + stat_summary_boxplot()
p
p + stat_info_boxplot(statistic = "n", y = 0) + labs(title = "Boxplots with number of observations")
p + stat_info_boxplot(statistic = "n", label = "N=", y = 10, text_color = "darkblue", text_size = 4) + labs(title = "Boxplots with number of observations")
p + stat_info_boxplot(statistic = "n", label = "N=", y = 10, text_color = "darkblue", text_size = 3) + labs(title = "Boxplots with number of observations")
p + stat_info_boxplot(statistic = "mean", label = "µ=", y = "min", text_color = "darkred", text_size = 3) + labs(title = "Boxplots with mean of observations")
p + stat_info_boxplot(statistic = "mean", label = "µ=", y = "q1", text_color = "darkred", text_size = 3) + labs(title = "Boxplots with mean of observations")
p + stat_info_boxplot(statistic = "mean", label = "µ=", y = "max", text_color = "darkred", text_size = 3) + labs(title = "Boxplots with mean of observations")
p + stat_info_boxplot(statistic = "mean", label = "µ=", y = "min", text_color = "darkred", text_size = 3) + labs(title = "Boxplots with mean of observations")
p + stat_info_boxplot(statistic = "median", label = "", y = "upper", text_color = "darkgreen", text_size = 3) + labs(title = "Boxplots with median of observations")
p + stat_info_boxplot(statistic = "sd", label = "sd=", y = "lower", text_color = "red", text_size = 3) + labs(title = "Boxplots with mean of observations")
p + stat_info_boxplot(statistic = "sd", label = "", y = "lower", text_color = "red", text_size = 3) + labs(title = "Boxplots with mean of observations")
p + stat_info_boxplot(statistic = "n", label = "N=", y = 10, text_color = "darkblue", text_size = 3) + labs(title = "Boxplots with number of observations")
p + stat_info_boxplot(statistic = "mean", label = "µ=", y = "min", text_color = "darkred", text_size = 3) + labs(title = "Boxplots with mean of observations")
p + stat_info_boxplot(statistic = "sd", label = "", y = "lower", text_color = "red", text_size = 3) + labs(title = "Boxplots with st. dev. of observations")
p + stat_info_boxplot(statistic = "median", label = "", y = "upper", text_color = "darkgreen", text_size = 3) + labs(title = "Boxplots with median of observations")
knitr::opts_chunk$set(echo = TRUE, fig.align = "center", fig.width = 4, fig.height = 4,
warning = FALSE, error = FALSE, message = FALSE)
devtools::load_all("..")
v <- shaded_2d_venn(highlight = "AB", color = "red")
d
v1 <- shaded_2d_venn(highlight = "AB", color = "red")
v1
v1 <- shaded_2d_venn(highlight = "AB", color = "red") + labs(title = "Intersection colored red")
v2 <- shaded_2d_venn(highlight = "noAB", color = "green") + labs(title = "B colored green")
v3 <- shaded_2d_venn(highlight = "AnoB", color = "yellow") + labs(title = "A colored yellow")
v4 <- shaded_2d_venn(highlight = c("AB", "AnoB", "noAB"), c("red", "yellow", "green")) + labs(title = "All areas colored distinctly")
v5 <- shaded_2d_venn(highlight = "all", color = "black", line.col = "white") + labs(title = "All areas colored blaxk and outline colored white")
v1 <- shaded_2d_venn(highlight = "AB", color = "red") + labs(title = "Intersection colored red")
v2 <- shaded_2d_venn(highlight = "noAB", color = "green") + labs(title = "B colored green")
v3 <- shaded_2d_venn(highlight = "AnoB", color = "yellow") + labs(title = "A colored yellow")
v4 <- shaded_2d_venn(highlight = c("AB", "AnoB", "noAB"), c("red", "yellow", "green")) + labs(title = "All colored")
v5 <- shaded_2d_venn(highlight = "all", color = "black", line.col = "white") + labs(title = "All black; outline white")
(v1 + v2 + v3) / (v4 + v5)
(v1 + v2 + v3) / (v4 + v5)
shaded_2d_venn
(v1 + v2 + v3) / (v4 + v5)
knitr::opts_chunk$set(echo = TRUE, fig.align = "center", fig.width = 4, fig.height = 4,
warning = FALSE, error = FALSE, message = FALSE)
devtools::load_all("..")
v1 <- shaded_3d_venn(highlight = "ABC", color = "red")
v2 <- shaded_3d_venn(highlight = c("AnoBnoC", "noABC"), c("yellow", "green"))
shaded_3d_venn <- function(highlight = c("ABC", "ABnoC", "AnoBC", "noABC", "AnoBnoC", "noABnoC", "noAnoBC"),
color = c("red", "pink", "blue", "yellow", "green", "orange", "purple"),
label = NULL,
label.pos = "bottom.right",
label.face = "italic",
label.size = 13,
label.col = "black",
line.col = "black"){
# load required packages
library(polyclip)
library(VennDiagram)
library(ggplot2)
library(cowplot)
# Check that parameters are OK.
if(!highlight %in% c("ABC", "ABnoC", "AnoBC", "noABC", "AnoBnoC", "noABnoC", "noAnoBC")){ stop("'highlight' must be a character vector with one or many of the intersection names or 'all'. If 'all', the character must be of length 1.") }
if(length(color) != length(highlight)){ stop("'color' must be a character vector with the same length as 'highlight'.") }
if(!label.pos %in% c("bottom.right", "right.bottom", "bottom.left", "left.bottom", "top.right", "right.top", "top.left", "left.top")){ stop("Incorrect value for 'label.pos'.") }
# Create base venn
invisible(vp <- VennDiagram::draw.triple.venn(area1 = 0, area2 = 0, area3 = 0, n12 = 0, n23 = 0, n13 = 0, n123 = 0,
category = rep("", 3), cex = 0, label.col = NA, scaled = F, fill = NA,
margin = 0, disable.logging = T))
# Take the circles
A <- list(list(x = as.vector(vp[[1]][[1]]), y = as.vector(vp[[1]][[2]])))
B <- list(list(x = as.vector(vp[[2]][[1]]), y = as.vector(vp[[2]][[2]])))
C <- list(list(x = as.vector(vp[[3]][[1]]), y = as.vector(vp[[3]][[2]])))
# Find the intersections and other areas
AB <- polyclip::polyclip(A,B)
AC <- polyclip::polyclip(A,C)
BC <- polyclip::polyclip(B,C)
# Intersection of all
ABC     <- polyclip::polyclip(A,B) %>% polyclip::polyclip(., C)
# Intersection of two, subtracting one
ABnoC   <- polyclip::polyclip(A,B) %>% polyclip::polyclip(., C, op = "minus")
AnoBC   <- polyclip::polyclip(A,C) %>% polyclip::polyclip(., B, op = "minus")
noABC   <- polyclip::polyclip(C, B) %>% polyclip::polyclip(., A, op = "minus")
# Specific of one area
AnoBnoC <- polyclip::polyclip(A,B, op = "minus") %>% polyclip::polyclip(., C, op = "minus")
noABnoC <- polyclip::polyclip(B,A, op = "minus") %>% polyclip::polyclip(., C, op = "minus")
noAnoBC <- polyclip::polyclip(C,A, op = "minus") %>% polyclip::polyclip(., B, op = "minus")
# Put all intersections in a list
sets <- list("ABC" = ABC, "ABnoC" = ABnoC, "AnoBC" = AnoBC, "noABC" = noABC, "AnoBnoC" = AnoBnoC, "noABnoC" = noABnoC, "noAnoBC" = noAnoBC)
# If highlight == "all" set to all clusters
if(highlight == "all") { highlight <- names(sets); color <- rep(color, 7)}
# Write a dataframe with the data from each circle
data <- data.frame(A=A, B=B, C=C)
# Draw the circles. Line color = black. Fill = NA.
venn <- ggplot(data) +
geom_polygon(mapping = aes(A.x, A.y), color = line.col, fill = NA, alpha = 1, size = 0.2) +
geom_polygon(mapping = aes(B.x, B.y), color = line.col, fill = NA, alpha = 1, size = 0.2) +
geom_polygon(mapping = aes(C.x, C.y), color = line.col, fill = NA, alpha = 1, size = 0.2)
# Highlight desired areas by drawing them
for(i in 1:length(highlight)){
set <- highlight[i]
new_data <- data.frame(set=sets[[set]])
venn <- venn + geom_polygon(data = new_data, aes(set.x,set.y), color = line.col, fill = color[i], alpha = 1, size = 0.2)
}
# Remove all the elements from the grid, axes...
venn <- venn + cowplot::theme_nothing()
# Add label if desired
if(!is.null(label)){
if(label.pos %in% c("bottom.right", "right.bottom")) { lab.x = 1; lab.y = .2 }
else if(label.pos %in% c("bottom.left", "left.bottom")) { lab.x = 0; lab.y = .2 }
else if(label.pos %in% c("top.right", "right.top")) { lab.x = 1; lab.y = .9 }
else if(label.pos %in% c("top.left", "left.top")) { lab.x = 0; lab.y = .9 }
venn <- venn + annotate(geom = "text", label = label, x = lab.x, y = lab.y, hjust = .5, size = label.size, fontface = label.face, color = label.col)
}
# Return venn with shaded areas
venn
}
v2 <- shaded_3d_venn(highlight = c("AnoBnoC", "noABC"), c("yellow", "green"))
v1 <- shaded_3d_venn(highlight = "ABC", color = "red")
v2 <- shaded_3d_venn(highlight = c("AnoBnoC", "noABC"), c("yellow", "green"))
v3 <- shaded_3d_venn(highlight = "all", color = "black", line.col = "white")
shaded_3d_venn <- function(highlight = c("ABC", "ABnoC", "AnoBC", "noABC", "AnoBnoC", "noABnoC", "noAnoBC"),
color = c("red", "pink", "blue", "yellow", "green", "orange", "purple"),
label = NULL,
label.pos = "bottom.right",
label.face = "italic",
label.size = 13,
label.col = "black",
line.col = "black"){
# load required packages
library(polyclip)
library(VennDiagram)
library(ggplot2)
library(cowplot)
# Check that parameters are OK.
if(!highlight %in% c("all", "ABC", "ABnoC", "AnoBC", "noABC", "AnoBnoC", "noABnoC", "noAnoBC")){ stop("'highlight' must be a character vector with one or many of the intersection names or 'all'. If 'all', the character must be of length 1.") }
if(length(color) != length(highlight)){ stop("'color' must be a character vector with the same length as 'highlight'.") }
if(!label.pos %in% c("bottom.right", "right.bottom", "bottom.left", "left.bottom", "top.right", "right.top", "top.left", "left.top")){ stop("Incorrect value for 'label.pos'.") }
# Create base venn
invisible(vp <- VennDiagram::draw.triple.venn(area1 = 0, area2 = 0, area3 = 0, n12 = 0, n23 = 0, n13 = 0, n123 = 0,
category = rep("", 3), cex = 0, label.col = NA, scaled = F, fill = NA,
margin = 0, disable.logging = T))
# Take the circles
A <- list(list(x = as.vector(vp[[1]][[1]]), y = as.vector(vp[[1]][[2]])))
B <- list(list(x = as.vector(vp[[2]][[1]]), y = as.vector(vp[[2]][[2]])))
C <- list(list(x = as.vector(vp[[3]][[1]]), y = as.vector(vp[[3]][[2]])))
# Find the intersections and other areas
AB <- polyclip::polyclip(A,B)
AC <- polyclip::polyclip(A,C)
BC <- polyclip::polyclip(B,C)
# Intersection of all
ABC     <- polyclip::polyclip(A,B) %>% polyclip::polyclip(., C)
# Intersection of two, subtracting one
ABnoC   <- polyclip::polyclip(A,B) %>% polyclip::polyclip(., C, op = "minus")
AnoBC   <- polyclip::polyclip(A,C) %>% polyclip::polyclip(., B, op = "minus")
noABC   <- polyclip::polyclip(C, B) %>% polyclip::polyclip(., A, op = "minus")
# Specific of one area
AnoBnoC <- polyclip::polyclip(A,B, op = "minus") %>% polyclip::polyclip(., C, op = "minus")
noABnoC <- polyclip::polyclip(B,A, op = "minus") %>% polyclip::polyclip(., C, op = "minus")
noAnoBC <- polyclip::polyclip(C,A, op = "minus") %>% polyclip::polyclip(., B, op = "minus")
# Put all intersections in a list
sets <- list("ABC" = ABC, "ABnoC" = ABnoC, "AnoBC" = AnoBC, "noABC" = noABC, "AnoBnoC" = AnoBnoC, "noABnoC" = noABnoC, "noAnoBC" = noAnoBC)
# If highlight == "all" set to all clusters
if(highlight == "all") { highlight <- names(sets); color <- rep(color, 7)}
# Write a dataframe with the data from each circle
data <- data.frame(A=A, B=B, C=C)
# Draw the circles. Line color = black. Fill = NA.
venn <- ggplot(data) +
geom_polygon(mapping = aes(A.x, A.y), color = line.col, fill = NA, alpha = 1, size = 0.2) +
geom_polygon(mapping = aes(B.x, B.y), color = line.col, fill = NA, alpha = 1, size = 0.2) +
geom_polygon(mapping = aes(C.x, C.y), color = line.col, fill = NA, alpha = 1, size = 0.2)
# Highlight desired areas by drawing them
for(i in 1:length(highlight)){
set <- highlight[i]
new_data <- data.frame(set=sets[[set]])
venn <- venn + geom_polygon(data = new_data, aes(set.x,set.y), color = line.col, fill = color[i], alpha = 1, size = 0.2)
}
# Remove all the elements from the grid, axes...
venn <- venn + cowplot::theme_nothing()
# Add label if desired
if(!is.null(label)){
if(label.pos %in% c("bottom.right", "right.bottom")) { lab.x = 1; lab.y = .2 }
else if(label.pos %in% c("bottom.left", "left.bottom")) { lab.x = 0; lab.y = .2 }
else if(label.pos %in% c("top.right", "right.top")) { lab.x = 1; lab.y = .9 }
else if(label.pos %in% c("top.left", "left.top")) { lab.x = 0; lab.y = .9 }
venn <- venn + annotate(geom = "text", label = label, x = lab.x, y = lab.y, hjust = .5, size = label.size, fontface = label.face, color = label.col)
}
# Return venn with shaded areas
venn
}
v3 <- shaded_3d_venn(highlight = "all", color = "black", line.col = "white")
(v1 + v2 + v3)
```{r fig.height=1.4 fig.width=7}
(v1 + v2 + v3)
```{r fig.height=1 fig.width=7}
(v1 + v2 + v3)
(v1 + v2 + v3)
aras <- shaded_3d_venn(highlight = "all", color = "white", line.col = "black")
areas <- shaded_3d_venn(highlight = "all", color = "white", line.col = "black")
a
areas
areas +
annotate("text", label = "AnoBnoC", x = .25, y = .25, hjust = .5, vjust = .5)
areas +
annotate("text", label = "AnoBnoC", x = .25, y = .75, hjust = .5, vjust = .5)
areas +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5)
areas +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
areas +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5)
areas +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5)
areas +
annotate("text", label = "AnoBnoC", x = .2, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .8, hjust = .5, vjust = .5)
areas +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBC", x = .3, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "ABC", x = .5, y = .5, hjust = .5, vjust = .5) +
annotate("text", label = "noABC", x = .7, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5)
areas +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBC", x = .3, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "ABC", x = .5, y = .55, hjust = .5, vjust = .5) +
annotate("text", label = "noABC", x = .7, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5)
areas +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBC", x = .3, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "ABC", x = .5, y = .55, hjust = .5, vjust = .5) +
annotate("text", label = "noABC", x = .7, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "noAnoBC", x = .5, y = .25, hjust = .5, vjust = .5)
areas +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBC", x = .3, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "ABC", x = .5, y = .55, hjust = .5, vjust = .5) +
annotate("text", label = "noABC", x = .7, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "noAnoBC", x = .5, y = .25, hjust = .5, vjust = .5) +
labs(title = "Name of each area")
areas +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBC", x = .3, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "ABC", x = .5, y = .55, hjust = .5, vjust = .5) +
annotate("text", label = "noABC", x = .7, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "noAnoBC", x = .5, y = .25, hjust = .5, vjust = .5) +
annotate("text", label = "Name of each area", x = .5, y = 1, hjust = .5, vjust = .5)
areas +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBC", x = .3, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "ABC", x = .5, y = .55, hjust = .5, vjust = .5) +
annotate("text", label = "noABC", x = .7, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "noAnoBC", x = .5, y = .25, hjust = .5, vjust = .5) +
annotate("text", label = "Name of each area", x = .5, y = 1, hjust = .5, vjust = 0, fontface = "bold")
areas +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBC", x = .3, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "ABC", x = .5, y = .55, hjust = .5, vjust = .5) +
annotate("text", label = "noABC", x = .7, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "noAnoBC", x = .5, y = .25, hjust = .5, vjust = .5) +
annotate("text", label = "Name of each area", x = .5, y = 1, hjust = .5, vjust = 0, fontface = "bold") +
coord_cartesian(ylim = c(0.25, 1))
areas +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBC", x = .3, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "ABC", x = .5, y = .55, hjust = .5, vjust = .5) +
annotate("text", label = "noABC", x = .7, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "noAnoBC", x = .5, y = .25, hjust = .5, vjust = .5) +
annotate("text", label = "Name of each area", x = .5, y = 1, hjust = .5, vjust = 0, fontface = "bold") +
coord_cartesian(ylim = c(0.1, 1.1))
areas +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBC", x = .3, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "ABC", x = .5, y = .55, hjust = .5, vjust = .5) +
annotate("text", label = "noABC", x = .7, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "noAnoBC", x = .5, y = .25, hjust = .5, vjust = .5) +
annotate("text", label = "Name of each area", x = .5, y = 1, hjust = .5, vjust = 0, fontface = "bold") +
coord_cartesian(ylim = c(0, 1.1))
areas +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBC", x = .3, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "ABC", x = .5, y = .55, hjust = .5, vjust = .5) +
annotate("text", label = "noABC", x = .7, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "noAnoBC", x = .5, y = .25, hjust = .5, vjust = .5) +
annotate("text", label = "Name of each area", x = .5, y = 1.1, hjust = .5, vjust = 0, fontface = "bold") +
coord_cartesian(ylim = c(0, 1.1))
areas +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBC", x = .3, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "ABC", x = .5, y = .55, hjust = .5, vjust = .5) +
annotate("text", label = "noABC", x = .7, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "noAnoBC", x = .5, y = .25, hjust = .5, vjust = .5) +
annotate("text", label = "Name of each area", x = .5, y = 1.06, hjust = .5, vjust = 0, fontface = "bold", size = 10) +
coord_cartesian(ylim = c(0, 1.1))
areas +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBC", x = .3, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "ABC", x = .5, y = .55, hjust = .5, vjust = .5) +
annotate("text", label = "noABC", x = .7, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "noAnoBC", x = .5, y = .25, hjust = .5, vjust = .5) +
annotate("text", label = "Name of each area", x = .5, y = 1.06, hjust = .5, vjust = 0, fontface = "bold", size = 8) +
coord_cartesian(ylim = c(0, 1.1))
areas <- shaded_3d_venn(highlight = "all", color = "white", line.col = "black") +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBC", x = .3, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "ABC", x = .5, y = .55, hjust = .5, vjust = .5) +
annotate("text", label = "noABC", x = .7, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "noAnoBC", x = .5, y = .25, hjust = .5, vjust = .5) +
annotate("text", label = "Name of each area", x = .5, y = 1.06, hjust = .5, vjust = 0, fontface = "bold", size = 8) +
coord_cartesian(ylim = c(0, 1.1))
areas
areas <- shaded_3d_venn(highlight = "all", color = "white", line.col = "black") +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBC", x = .3, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "ABC", x = .5, y = .55, hjust = .5, vjust = .5) +
annotate("text", label = "noABC", x = .7, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "noAnoBC", x = .5, y = .25, hjust = .5, vjust = .5) +
annotate("text", label = "Name of each area", x = .5, y = 1.06, hjust = .5, vjust = 0, fontface = "bold", size = 8) +
coord_cartesian(ylim = c(0, 1.1))
areas
# Load ggplot2
library(ggplot2)
# Load ggmitji
library(ggmitji)
# Load patchwork (to put plots together)
library(patchwork)
#areas <-
shaded_2d_venn(highlight = "all", color = "white", line.col = "black") +
annotate("text", label = "AnoBnoC", x = .2, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBC", x = .3, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "ABC", x = .5, y = .55, hjust = .5, vjust = .5) +
annotate("text", label = "noABC", x = .7, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "noAnoBC", x = .5, y = .25, hjust = .5, vjust = .5) +
annotate("text", label = "Name of each area", x = .5, y = 1.06, hjust = .5, vjust = 0, fontface = "bold", size = 8) +
coord_cartesian(ylim = c(0, 1.1))
#areas <-
shaded_2d_venn(highlight = "all", color = "white", line.col = "black") +
annotate("text", label = "AB", x = .5, y = .5, hjust = .5, vjust = .5) +
annotate("text", label = "ABnoC", x = .5, y = .8, hjust = .5, vjust = .5) +
annotate("text", label = "noABnoC", x = .8, y = .75, hjust = .5, vjust = .5) +
annotate("text", label = "AnoBC", x = .3, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "ABC", x = .5, y = .55, hjust = .5, vjust = .5) +
annotate("text", label = "noABC", x = .7, y = .45, hjust = .5, vjust = .5) +
annotate("text", label = "noAnoBC", x = .5, y = .25, hjust = .5, vjust = .5) +
annotate("text", label = "Name of each area", x = .5, y = 1.06, hjust = .5, vjust = 0, fontface = "bold", size = 8) +
coord_cartesian(ylim = c(0, 1))
#areas <-
shaded_2d_venn(highlight = "all", color = "white", line.col = "black") +
annotate("text", label = "AB", x = .5, y = .5, hjust = .5, vjust = .5) +
annotate("text", label = "AnoB", x = .3, y = .5, hjust = .5, vjust = .5) +
annotate("text", label = "noAB", x = .7, y = .5, hjust = .5, vjust = .5) + +
annotate("text", label = "Name of each area", x = .5, y = 1.06, hjust = .5, vjust = 0, fontface = "bold", size = 8) +
coord_cartesian(ylim = c(0, 1))
#areas <-
shaded_2d_venn(highlight = "all", color = "white", line.col = "black") +
annotate("text", label = "AB", x = .5, y = .5, hjust = .5, vjust = .5) +
annotate("text", label = "AnoB", x = .3, y = .5, hjust = .5, vjust = .5) +
annotate("text", label = "noAB", x = .7, y = .5, hjust = .5, vjust = .5) +
annotate("text", label = "Name of each area", x = .5, y = 1.06, hjust = .5, vjust = 0, fontface = "bold", size = 8) +
coord_cartesian(ylim = c(0, 1))
#areas <-
shaded_2d_venn(highlight = "all", color = "white", line.col = "black") +
annotate("text", label = "AB", x = .5, y = .5, hjust = .5, vjust = .5) +
annotate("text", label = "AnoB", x = .15, y = .5, hjust = .5, vjust = .5) +
annotate("text", label = "noAB", x = .85, y = .5, hjust = .5, vjust = .5) +
annotate("text", label = "Name of each area", x = .5, y = 1.06, hjust = .5, vjust = 0, fontface = "bold", size = 8) +
coord_cartesian(ylim = c(0, 1))
#areas <-
shaded_2d_venn(highlight = "all", color = "white", line.col = "black") +
annotate("text", label = "AB", x = .5, y = .5, hjust = .5, vjust = .5) +
annotate("text", label = "AnoB", x = .2, y = .5, hjust = .5, vjust = .5) +
annotate("text", label = "noAB", x = .8, y = .5, hjust = .5, vjust = .5) +
annotate("text", label = "Name of each area", x = .5, y = 1.06, hjust = .5, vjust = 0, fontface = "bold", size = 8) +
coord_cartesian(ylim = c(0, 1))
areas <-
shaded_2d_venn(highlight = "all", color = "white", line.col = "black") +
annotate("text", label = "AB", x = .5, y = .5, hjust = .5, vjust = .5) +
annotate("text", label = "AnoB", x = .2, y = .5, hjust = .5, vjust = .5) +
annotate("text", label = "noAB", x = .8, y = .5, hjust = .5, vjust = .5) +
annotate("text", label = "Name of each area", x = .5, y = 1.06, hjust = .5, vjust = 0, fontface = "bold", size = 8) +
coord_cartesian(ylim = c(0, 1))
devtools::document()
pkgdown::build_site()
devtools::document()
pkgdown::build_site()
pkgdown::build_home()
pkgdown::build_home()
# Create base boxplot with geom_boxplot, stat_boxplot or stat_summary_boxplot
p <- ggplot(mpg, aes(class, hwy)) + stat_summary_boxplot()
p
stat_info_boxplot
fivenum
stat_point_boxplot <- function(point_size = 2,
point_color = "black",
width = .5,
stat = "mean",
statistic = "n",
label = ""){
# Check and format the inputs.
if(is.character(stat)){ stat <- tolower(stat) }
else if(!stat %in% c('mean', 'median', 'q1', 'q2', 'q3', 'q4', 'min', 'max')){ stop("'statistic' must be one of, 'mean', 'median', 'q1', 'q2', 'q3', 'q4', 'min' or 'max'.") }
# Define internal function to calculate the Y, and define the label.
calc_point_boxplot <- function(x){
# Define Y
if(stat == "min"){ y = fivenum(x)[1] }  ## min value of the boxplot
else if(stat %in% c("max", "q4")){ y = fivenum(x)[5] }  ## max value of the boxplot
else if(stat == "q1"){ y = fivenum(x)[2] }  ## q1 value of the boxplot (value 25%)
else if(stat %in% c("median", "q2")){ y = fivenum(x)[3] }  ## median value of the boxplot (value 50%)
else if(stat == "q3"){ y = fivenum(x)[4] }  ## q3 value of the boxplot (value 75%)
else if(stat == "mean"){ y = mean(x) }  ## mean value of the boxplot
# Create the dataframe with the values
n <- data.frame(y = y)
# Return the dataframe
return(n)
}
# Call stat summary with the infor function
stat_summary(fun.data = calc_point_boxplot, geom = "point", size = point_size, color = point_color, position = position_dodge(width = width))
}
p + stat_point_boxplot()
p + stat_point_boxplot(stat = "max")
p + stat_point_boxplot(stat = "min")
p + stat_point_boxplot(stat = "q1")
p + stat_point_boxplot(stat = "q2")
p + stat_point_boxplot(stat = "q4")
p + stat_point_boxplot(stat = "q3")
p + stat_point_boxplot(stat = "mean")
stat_point_boxplot <- function(stat = "mean",
width = .5,
point_size = 2,
point_color = "red"){
# Check and format the inputs.
if(is.character(stat)){ stat <- tolower(stat) }
else if(!stat %in% c('mean', 'median', 'q1', 'q2', 'q3', 'q4', 'min', 'max')){ stop("'statistic' must be one of 'mean', 'median', 'q1', 'q2', 'q3', 'q4', 'min' or 'max'.") }
# Define internal function to calculate the Y, and define the label.
calc_point_boxplot <- function(x){
# Define Y
if(stat == "min"){ y = fivenum(x)[1] }  ## min value of the boxplot
else if(stat %in% c("max", "q4")){ y = fivenum(x)[5] }  ## max value of the boxplot
else if(stat == "q1"){ y = fivenum(x)[2] }  ## q1 value of the boxplot (value 25%)
else if(stat %in% c("median", "q2")){ y = fivenum(x)[3] }  ## median value of the boxplot (value 50%)
else if(stat == "q3"){ y = fivenum(x)[4] }  ## q3 value of the boxplot (value 75%)
else if(stat == "mean"){ y = mean(x) }  ## mean value of the boxplot
# Create the dataframe with the values
n <- data.frame(y = y)
# Return the dataframe
return(n)
}
# Call stat summary with the infor function
stat_summary(fun.data = calc_point_boxplot, geom = "point", size = point_size, color = point_color, position = position_dodge(width = width))
}
knitr::opts_chunk$set(echo = TRUE, fig.align = "center", fig.width = 4, fig.height = 4,
warning = FALSE, error = FALSE, message = FALSE)
devtools::load_all("..")
# Load ggplot2
library(ggplot2)
# Load ggmitji
library(ggmitji)
# Load patchwork (to put plots together)
library(patchwork)
# Create base boxplot with geom_boxplot, stat_boxplot or stat_summary_boxplot
p <- ggplot(mpg, aes(class, hwy)) + stat_summary_boxplot()
p
p + stat_point_boxplot(stat = "mean") + labs(title = "Boxplots with mean of observations")
p + stat_point_boxplot(stat = "median") + labs(title = "Boxplots with median of observations")
p + stat_point_boxplot(stat = "min") + labs(title = "Boxplots with median of observations")
p + stat_point_boxplot(stat = "max") + labs(title = "Boxplots with median of observations")
p + stat_point_boxplot(stat = "mean") + labs(title = "Boxplots with mean of observations")
p + stat_point_boxplot(stat = "median") + labs(title = "Boxplots with median of observations")
p + stat_point_boxplot(stat = "min") + labs(title = "Boxplots with smallest observation")
p + stat_point_boxplot(stat = "max") + labs(title = "Boxplots with highest observation")
devtools::document()
pkgdown::build_site()
pkgdown::build_home()
pkgdown::build_home()
pkgdown::build_home()
